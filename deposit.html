<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Cashpoint | Deposit Funds</title>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>

<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Sora:wght@400;600;700&display=swap" rel="stylesheet">

<style>
  :root {
    --primary:       #0052FF;
    --primary-light: #3b7dff;
    --primary-dark:  #0039b3;
    --accent:        #00D4A0;
    --accent-dark:   #00a87e;
    --warning:       #FFB800;
    --danger:        #FF4D6D;
    --success:       #00C48C;
    --bg:            #F0F4FF;
    --card:          #ffffff;
    --text:          #0D1B3E;
    --muted:         #6B7A99;
    --border:        #D8E0F0;
    --nav-h:         70px;
    --bottom-h:      72px;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }
  html { scroll-behavior: smooth; }

  body {
    font-family: 'Plus Jakarta Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    padding-bottom: calc(var(--bottom-h) + 20px);
    overflow-x: hidden;
    min-height: 100vh;
  }

  /* â•â•â•â•â•â•â•â• TOP BAR â•â•â•â•â•â•â•â• */
  .topbar {
    position: sticky; top: 0; z-index: 900;
    height: var(--nav-h);
    background: rgba(255,255,255,0.92);
    backdrop-filter: blur(18px);
    -webkit-backdrop-filter: blur(18px);
    border-bottom: 1px solid var(--border);
    display: flex; align-items: center;
    justify-content: space-between;
    padding: 0 20px; gap: 12px;
  }
  .topbar-left { display: flex; align-items: center; gap: 10px; }
  .topbar-logo {
    width: 38px; height: 38px; background: var(--primary);
    border-radius: 11px; display: flex; align-items: center;
    justify-content: center; font-size: 20px; flex-shrink: 0;
  }
  .topbar-brand {
    font-family: 'Sora', sans-serif; font-size: 20px;
    font-weight: 700; color: var(--text); letter-spacing: -0.3px;
  }
  .topbar-right { display: flex; align-items: center; gap: 10px; }
  .topbar-clock { font-size: 12.5px; color: var(--muted); font-weight: 600; display: none; }
  @media(min-width:520px){ .topbar-clock { display: block; } }
  .user-avatar {
    width: 38px; height: 38px; border-radius: 11px;
    background: linear-gradient(135deg, var(--primary), var(--accent));
    display: flex; align-items: center; justify-content: center;
    color: white; font-weight: 800; font-size: 15px; cursor: pointer;
  }

  /* â•â•â•â•â•â•â•â• HERO â•â•â•â•â•â•â•â• */
  .hero {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 55%, #001c6b 100%);
    padding: 28px 22px 90px;
    position: relative; overflow: hidden;
  }
  .hero::before {
    content: ''; position: absolute; width: 360px; height: 360px;
    border-radius: 50%; background: rgba(255,255,255,0.05); top: -100px; right: -80px;
  }
  .hero::after {
    content: ''; position: absolute; width: 200px; height: 200px;
    border-radius: 50%; background: rgba(0,212,160,0.1); bottom: -60px; left: -40px;
  }
  .hero-tag {
    font-size: 11.5px; font-weight: 700; color: rgba(255,255,255,0.6);
    text-transform: uppercase; letter-spacing: 0.08em;
    margin-bottom: 5px; position: relative; z-index: 1;
  }
  .hero-title {
    font-family: 'Sora', sans-serif; font-size: clamp(22px,5.5vw,30px);
    font-weight: 700; color: #fff; margin-bottom: 6px; position: relative; z-index: 1;
  }
  .hero-sub { font-size: 13px; color: rgba(255,255,255,0.65); font-weight: 500; position: relative; z-index: 1; }

  /* â•â•â•â•â•â•â•â• BALANCE CARD (floating) â•â•â•â•â•â•â•â• */
  .balance-outer {
    padding: 0 16px; margin-top: -52px; position: relative; z-index: 10;
  }
  .balance-card {
    background: white; border-radius: 22px;
    box-shadow: 0 14px 44px rgba(0,82,255,0.14);
    padding: 18px 22px;
    display: flex; align-items: center;
    justify-content: space-between; gap: 12px; flex-wrap: wrap;
    animation: riseUp 0.5s cubic-bezier(0.16,1,0.3,1) both;
  }
  @keyframes riseUp {
    from { opacity:0; transform:translateY(22px); }
    to   { opacity:1; transform:translateY(0); }
  }
  .bal-lbl {
    font-size: 11px; font-weight: 700; color: var(--muted);
    text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 4px;
  }
  .bal-amount {
    font-family: 'Sora', sans-serif; font-size: clamp(22px,5.5vw,30px);
    font-weight: 700; color: var(--text); letter-spacing: -1px; line-height: 1;
  }
  .bal-amount .sym { font-size: 14px; color: var(--muted); font-weight: 600; }
  .bal-pill {
    display: inline-flex; align-items: center; gap: 5px;
    background: #E8FFF6; color: var(--success); border-radius: 99px;
    padding: 3px 10px; font-size: 11px; font-weight: 700; margin-top: 7px;
  }
  .pending-pill {
    display: inline-flex; align-items: center; gap: 5px;
    background: #FFF8E8; color: var(--warning); border-radius: 99px;
    padding: 4px 12px; font-size: 12px; font-weight: 700;
    border: 1.5px solid #ffe0a0;
  }

  /* â•â•â•â•â•â•â•â• SECTION â•â•â•â•â•â•â•â• */
  .section { padding: 24px 16px 0; }
  .section-head { display: flex; align-items: center; justify-content: space-between; margin-bottom: 14px; }
  .section-title { font-family: 'Sora', sans-serif; font-size: 17px; font-weight: 700; color: var(--text); }

  /* â•â•â•â•â•â•â•â• WARNING STRIP â•â•â•â•â•â•â•â• */
  .warn-strip {
    background: #FFF8E8;
    border: 1.5px solid #ffe0a0;
    border-radius: 16px; padding: 14px 18px;
    display: flex; align-items: flex-start; gap: 12px;
    animation: riseUp 0.5s cubic-bezier(0.16,1,0.3,1) both;
  }
  .warn-icon { font-size: 22px; flex-shrink: 0; }
  .warn-title { font-size: 13px; font-weight: 700; color: #856404; margin-bottom: 3px; }
  .warn-sub   { font-size: 12px; color: #856404; line-height: 1.5; }

  /* â•â•â•â•â•â•â•â• BANK CARD â•â•â•â•â•â•â•â• */
  .bank-card {
    background: white; border-radius: 22px;
    box-shadow: 0 6px 24px rgba(0,82,255,0.1);
    overflow: hidden;
    animation: riseUp 0.5s cubic-bezier(0.16,1,0.3,1) both;
  }
  .bank-card-header {
    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
    padding: 18px 22px;
    display: flex; align-items: center; gap: 12px;
  }
  .bank-logo {
    width: 44px; height: 44px; border-radius: 12px;
    background: rgba(255,255,255,0.2);
    display: flex; align-items: center; justify-content: center;
    font-size: 22px;
  }
  .bank-header-info {}
  .bank-name-lbl { font-size: 11px; font-weight: 700; color: rgba(255,255,255,0.7); margin-bottom: 2px; }
  .bank-name-val { font-family: 'Sora', sans-serif; font-size: 18px; font-weight: 700; color: white; }

  .bank-card-body { padding: 18px 22px; display: flex; flex-direction: column; gap: 10px; }

  .bank-row {
    display: flex; align-items: center; justify-content: space-between;
    background: var(--bg); border-radius: 12px; padding: 12px 16px; gap: 10px;
  }
  .bank-row-left {}
  .bank-row-lbl { font-size: 10.5px; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 3px; }
  .bank-row-val { font-size: 16px; font-weight: 700; color: var(--text); }
  .bank-row-val.big { font-family: 'Sora', sans-serif; font-size: 22px; letter-spacing: 1px; }
  .copy-btn {
    display: flex; align-items: center; gap: 6px;
    background: var(--primary); color: white; border: none;
    border-radius: 9px; padding: 7px 14px; font-size: 12.5px; font-weight: 700;
    font-family: inherit; cursor: pointer; flex-shrink: 0;
    transition: transform 0.15s, opacity 0.2s;
  }
  .copy-btn:hover { opacity: 0.88; transform: scale(1.04); }

  /* â•â•â•â•â•â•â•â• HOW IT WORKS â•â•â•â•â•â•â•â• */
  .steps-grid {
    display: grid; grid-template-columns: repeat(2,1fr); gap: 10px;
  }
  @media(min-width:560px){ .steps-grid { grid-template-columns: repeat(4,1fr); } }
  .step-tile {
    background: white; border-radius: 16px; padding: 16px 12px; text-align: center;
    box-shadow: 0 4px 14px rgba(0,82,255,0.07);
  }
  .step-num {
    width: 32px; height: 32px; background: var(--primary); color: white;
    border-radius: 10px; display: flex; align-items: center; justify-content: center;
    font-weight: 800; font-size: 14px; margin: 0 auto 9px;
  }
  .step-title { font-size: 12.5px; font-weight: 700; color: var(--text); margin-bottom: 4px; }
  .step-desc  { font-size: 11px; color: var(--muted); line-height: 1.5; }

  /* â•â•â•â•â•â•â•â• AMOUNT SELECTOR â•â•â•â•â•â•â•â• */
  .amounts-grid {
    display: grid; grid-template-columns: repeat(3,1fr); gap: 10px;
  }
  @media(min-width:480px){ .amounts-grid { grid-template-columns: repeat(4,1fr); } }
  @media(min-width:640px){ .amounts-grid { grid-template-columns: repeat(6,1fr); } }

  .amt-btn {
    background: white; border: 2px solid var(--border);
    border-radius: 14px; padding: 14px 8px; text-align: center;
    cursor: pointer; transition: all 0.2s; font-family: inherit;
  }
  .amt-btn:hover { border-color: var(--primary); background: #E8F0FF; }
  .amt-btn.active {
    border-color: var(--primary); background: var(--primary);
  }
  .amt-btn .amt-label {
    font-size: 13px; font-weight: 700; color: var(--text);
    transition: color 0.2s;
  }
  .amt-btn.active .amt-label { color: white; }
  .amt-btn .amt-earn {
    font-size: 10px; font-weight: 600; color: var(--success);
    margin-top: 3px; transition: color 0.2s;
  }
  .amt-btn.active .amt-earn { color: rgba(255,255,255,0.85); }

  /* â•â•â•â•â•â•â•â• CUSTOM AMOUNT INPUT â•â•â•â•â•â•â•â• */
  .custom-wrap {
    background: white; border-radius: 16px; padding: 18px;
    box-shadow: 0 4px 16px rgba(0,82,255,0.07);
  }
  .custom-wrap label {
    display: block; font-size: 12px; font-weight: 700; color: var(--muted);
    text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 10px;
  }
  .custom-input-row {
    display: flex; align-items: center; gap: 0;
    border: 2px solid var(--border); border-radius: 12px; overflow: hidden;
    transition: border-color 0.2s;
  }
  .custom-input-row:focus-within { border-color: var(--primary); }
  .custom-prefix {
    padding: 14px 16px; background: var(--bg); font-size: 18px;
    font-weight: 700; color: var(--muted); border-right: 2px solid var(--border);
    flex-shrink: 0;
  }
  .custom-input {
    flex: 1; padding: 14px 16px; font-size: 18px; font-weight: 700;
    font-family: inherit; border: none; outline: none; color: var(--text);
    min-width: 0;
  }
  .custom-input::placeholder { color: var(--border); }
  .custom-min-note {
    font-size: 12px; color: var(--muted); font-weight: 600; margin-top: 8px;
  }

  /* Selected amount preview */
  .amount-preview {
    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
    border-radius: 16px; padding: 16px 20px;
    display: flex; align-items: center; justify-content: space-between;
    display: none;
  }
  .amount-preview.visible { display: flex; }
  .ap-left {}
  .ap-lbl { font-size: 11.5px; font-weight: 700; color: rgba(255,255,255,0.7); margin-bottom: 4px; }
  .ap-amt {
    font-family: 'Sora', sans-serif; font-size: 26px; font-weight: 700; color: white; letter-spacing: -0.5px;
  }
  .ap-right { text-align: right; }
  .ap-earn-lbl { font-size: 11px; color: rgba(255,255,255,0.7); margin-bottom: 3px; }
  .ap-earn-val { font-size: 15px; font-weight: 700; color: var(--accent); }

  /* â•â•â•â•â•â•â•â• PAY BUTTON â•â•â•â•â•â•â•â• */
  .pay-btn {
    width: 100%; padding: 16px; border: none; border-radius: 16px;
    font-size: 17px; font-weight: 700; font-family: inherit; cursor: pointer;
    color: white;
    background: linear-gradient(135deg, #25D366, #128C7E);
    box-shadow: 0 8px 28px rgba(37,211,102,0.35);
    display: flex; align-items: center; justify-content: center; gap: 10px;
    transition: transform 0.15s, box-shadow 0.15s;
  }
  .pay-btn:hover { transform: translateY(-2px); box-shadow: 0 12px 36px rgba(37,211,102,0.45); }
  .pay-btn:active { transform: translateY(0); }

  /* â•â•â•â•â•â•â•â• DEPOSIT HISTORY â•â•â•â•â•â•â•â• */
  .dep-history { display: flex; flex-direction: column; gap: 10px; }
  .dep-item {
    background: white; border-radius: 16px; padding: 14px 18px;
    display: flex; align-items: center; gap: 14px;
    box-shadow: 0 3px 12px rgba(0,82,255,0.06);
    animation: riseUp 0.4s cubic-bezier(0.16,1,0.3,1) both;
  }
  .dep-icon {
    width: 42px; height: 42px; border-radius: 12px;
    display: flex; align-items: center; justify-content: center; font-size: 18px; flex-shrink: 0;
  }
  .dep-icon.pending   { background: #FFF8E8; }
  .dep-icon.approved  { background: #E8FFF6; }
  .dep-icon.rejected  { background: #FFF0F3; }
  .dep-info { flex: 1; min-width: 0; }
  .dep-amount { font-size: 15px; font-weight: 700; color: var(--text); }
  .dep-date   { font-size: 11.5px; color: var(--muted); font-weight: 600; margin-top: 2px; }
  .dep-right  { text-align: right; flex-shrink: 0; }
  .dep-badge  {
    display: inline-block; padding: 4px 11px; border-radius: 99px;
    font-size: 11px; font-weight: 700; text-transform: capitalize;
  }
  .dep-badge.pending  { background: #FFF8E8; color: var(--warning); }
  .dep-badge.approved { background: #E8FFF6; color: var(--success); }
  .dep-badge.rejected { background: #FFF0F3; color: var(--danger); }
  .dep-ref { font-size: 10px; color: var(--muted); font-weight: 600; margin-top: 3px; }

  .empty-history {
    background: white; border-radius: 16px; padding: 36px 24px; text-align: center;
    box-shadow: 0 3px 12px rgba(0,82,255,0.06);
  }
  .empty-history-emoji { font-size: 42px; margin-bottom: 10px; }
  .empty-history-title { font-size: 15px; font-weight: 700; color: var(--text); margin-bottom: 5px; }
  .empty-history-sub   { font-size: 13px; color: var(--muted); }

  /* â•â•â•â•â•â•â•â• SKELETON â•â•â•â•â•â•â•â• */
  .skeleton {
    background: linear-gradient(90deg,#e8edf5 25%,#f4f7fc 50%,#e8edf5 75%);
    background-size: 200% 100%; animation: shimmer 1.5s infinite; border-radius: 9px;
  }
  @keyframes shimmer { 0%{background-position:200% 0;} 100%{background-position:-200% 0;} }

  /* â•â•â•â•â•â•â•â• BOTTOM NAV â•â•â•â•â•â•â•â• */
  .bottom-nav {
    position: fixed; bottom: 0; left: 0;
    width: 100%; height: var(--bottom-h);
    background: white; border-top: 1px solid var(--border);
    display: flex; align-items: center; justify-content: space-around;
    padding: 0 8px; z-index: 999;
    box-shadow: 0 -4px 24px rgba(0,82,255,0.09);
  }
  .nav-item {
    display: flex; flex-direction: column; align-items: center; gap: 4px;
    text-decoration: none; padding: 8px 12px; border-radius: 14px;
    flex: 1; max-width: 74px; transition: background 0.2s; cursor: pointer;
  }
  .nav-item:hover { background: var(--bg); }
  .nav-item i { font-size: 20px; color: var(--muted); transition: color 0.2s, transform 0.2s; }
  .nav-item span { font-size: 10.5px; font-weight: 700; color: var(--muted); transition: color 0.2s; }
  .nav-item.active i, .nav-item.active span { color: var(--primary); }
  .nav-item.active i { transform: translateY(-2px); }
  .nav-center {
    width: 52px; height: 52px; border-radius: 16px; background: var(--primary);
    display: flex; align-items: center; justify-content: center;
    box-shadow: 0 6px 22px rgba(0,82,255,0.38);
    text-decoration: none; transition: transform 0.2s; margin-bottom: 10px; flex-shrink: 0;
  }
  .nav-center:hover { transform: translateY(-3px); }
  .nav-center i { color: white; font-size: 21px; }

  .page-bottom { height: 16px; }
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â• TOP BAR â•â•â•â•â•â•â•â•â•â• -->
<div class="topbar">
  <div class="topbar-left">
    <div class="topbar-logo">ğŸ’°</div>
    <span class="topbar-brand">Deposit Funds</span>
  </div>
  <div class="topbar-right">
    <span class="topbar-clock" id="topClock">--:--</span>
    <div class="user-avatar" id="avatarBox">?</div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• HERO â•â•â•â•â•â•â•â•â•â• -->
<div class="hero">
  <div class="hero-tag">Fund Your Account</div>
  <div class="hero-title">Make a Deposit ğŸ’³</div>
  <div class="hero-sub">Transfer to our account â€” admin approves and credits you</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• BALANCE CARD â•â•â•â•â•â•â•â•â•â• -->
<div class="balance-outer">
  <div class="balance-card">
    <div>
      <div class="bal-lbl">Available Balance</div>
      <div class="bal-amount">
        <span class="sym">â‚¦</span><span id="balanceDisplay">0.00</span>
      </div>
      <div class="bal-pill">
        <i class="fas fa-circle" style="font-size:7px;"></i> Account Active
      </div>
    </div>
    <div id="pendingWrap" style="display:none;">
      <div class="pending-pill">
        <i class="fas fa-clock" style="font-size:10px;"></i>
        <span id="pendingCount">0</span> Pending
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• WARNING â•â•â•â•â•â•â•â•â•â• -->
<div class="section">
  <div class="warn-strip">
    <div class="warn-icon">âš ï¸</div>
    <div>
      <div class="warn-title">Important â€” Read Before Depositing</div>
      <div class="warn-sub">Only transfer to the official account below. Do not send to any other account. Admin confirms manually within 5â€“30 minutes. Screenshot your transfer for reference.</div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• BANK ACCOUNT CARD â•â•â•â•â•â•â•â•â•â• -->
<div class="section">
  <div class="section-head">
    <div class="section-title">Transfer To This Account</div>
  </div>
  <div class="bank-card">
    <div class="bank-card-header">
      <div class="bank-logo">ğŸ¦</div>
      <div class="bank-header-info">
        <div class="bank-name-lbl">Bank</div>
        <div class="bank-name-val">PALMPAY</div>
      </div>
    </div>
    <div class="bank-card-body">

      <div class="bank-row">
        <div class="bank-row-left">
          <div class="bank-row-lbl">Account Number</div>
          <div class="bank-row-val big" id="accNum">9167378733</div>
        </div>
        <button class="copy-btn" onclick="copyField('9167378733', this)">
          <i class="fas fa-copy"></i> Copy
        </button>
      </div>

      <div class="bank-row">
        <div class="bank-row-left">
          <div class="bank-row-lbl">Account Name</div>
          <div class="bank-row-val">TAUFEEK MUFTAU</div>
        </div>
        <button class="copy-btn" onclick="copyField('TAUFEEK MUFTAU', this)">
          <i class="fas fa-copy"></i> Copy
        </button>
      </div>

      <div class="bank-row">
        <div class="bank-row-left">
          <div class="bank-row-lbl">Bank Name</div>
          <div class="bank-row-val">PALMPAY</div>
        </div>
        <button class="copy-btn" onclick="copyField('PALMPAY', this)">
          <i class="fas fa-copy"></i> Copy
        </button>
      </div>

    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• HOW IT WORKS â•â•â•â•â•â•â•â•â•â• -->
<div class="section">
  <div class="section-head">
    <div class="section-title">How to Deposit</div>
  </div>
  <div class="steps-grid">
    <div class="step-tile">
      <div class="step-num">1</div>
      <div class="step-title">Pick Amount</div>
      <div class="step-desc">Select a preset amount or type a custom value below.</div>
    </div>
    <div class="step-tile">
      <div class="step-num">2</div>
      <div class="step-title">Transfer</div>
      <div class="step-desc">Send exactly that amount to the Palmpay account above.</div>
    </div>
    <div class="step-tile">
      <div class="step-num">3</div>
      <div class="step-title">Notify Admin</div>
      <div class="step-desc">Click "I Have Paid" and enter your transfer reference for admin verification.</div>
    </div>
    <div class="step-tile">
      <div class="step-num">4</div>
      <div class="step-title">Get Credited</div>
      <div class="step-desc">Your balance is updated within 5â€“30 minutes after confirmation.</div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• AMOUNT SELECTOR â•â•â•â•â•â•â•â•â•â• -->
<div class="section">
  <div class="section-head">
    <div class="section-title">Choose Amount</div>
  </div>
  <div class="amounts-grid" id="amountsGrid">
    <!-- Rendered by JS -->
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• CUSTOM AMOUNT â•â•â•â•â•â•â•â•â•â• -->
<div class="section">
  <div class="custom-wrap">
    <label>Or Enter Custom Amount (Min â‚¦3,000)</label>
    <div class="custom-input-row">
      <div class="custom-prefix">â‚¦</div>
      <input
        class="custom-input"
        id="customAmtInput"
        type="number"
        placeholder="0"
        min="3000"
        oninput="onCustomInput(this.value)"
      />
    </div>
    <div class="custom-min-note">Minimum deposit: â‚¦3,000</div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• AMOUNT PREVIEW â•â•â•â•â•â•â•â•â•â• -->
<div class="section">
  <div class="amount-preview" id="amountPreview">
    <div class="ap-left">
      <div class="ap-lbl">You are depositing</div>
      <div class="ap-amt" id="previewAmt">â‚¦0</div>
    </div>
    <div class="ap-right">
      <div class="ap-earn-lbl">Minimum Plan</div>
      <div class="ap-earn-val" id="previewPlan">â€”</div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• PAY BUTTON â•â•â•â•â•â•â•â•â•â• -->
<div class="section">
  <button class="pay-btn" onclick="submitDeposit()">
    <i class="fas fa-paper-plane" style="font-size:18px;"></i>
    I Have Paid â€” Submit for Approval
  </button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• CUSTOMER SERVICE â•â•â•â•â•â•â•â•â•â• -->
<div class="section">
  <div style="background:linear-gradient(135deg,#25D366,#128C7E);border-radius:18px;padding:18px 20px;display:flex;align-items:center;gap:14px;box-shadow:0 6px 22px rgba(37,211,102,0.25);">
    <div style="width:48px;height:48px;background:rgba(255,255,255,0.2);border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0;">ğŸ§</div>
    <div style="flex:1;">
      <div style="font-size:13px;font-weight:800;color:white;margin-bottom:2px;">CASHPOINT CUSTOMER SERVICE</div>
      <div style="font-size:12px;color:rgba(255,255,255,0.85);font-weight:500;margin-bottom:10px;">Have a question about your deposit? Chat with us on WhatsApp.</div>
      <a href="https://wa.me/2347018051146" target="_blank"
         style="display:inline-flex;align-items:center;gap:7px;background:white;color:#128C7E;border-radius:99px;padding:7px 16px;font-size:13px;font-weight:800;text-decoration:none;font-family:inherit;">
        <i class="fab fa-whatsapp" style="font-size:16px;"></i> Chat on WhatsApp
      </a>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• DEPOSIT HISTORY â•â•â•â•â•â•â•â•â•â• -->
<div class="section">
  <div class="section-head">
    <div class="section-title">My Deposit History</div>
  </div>
  <div class="dep-history" id="depositHistory">
    <!-- Skeleton -->
    <div style="background:white;border-radius:16px;padding:14px 18px;display:flex;gap:14px;align-items:center;">
      <div class="skeleton" style="width:42px;height:42px;border-radius:12px;flex-shrink:0;"></div>
      <div style="flex:1;">
        <div class="skeleton" style="height:14px;width:50%;margin-bottom:7px;"></div>
        <div class="skeleton" style="height:11px;width:65%;"></div>
      </div>
    </div>
    <div style="background:white;border-radius:16px;padding:14px 18px;display:flex;gap:14px;align-items:center;">
      <div class="skeleton" style="width:42px;height:42px;border-radius:12px;flex-shrink:0;"></div>
      <div style="flex:1;">
        <div class="skeleton" style="height:14px;width:40%;margin-bottom:7px;"></div>
        <div class="skeleton" style="height:11px;width:55%;"></div>
      </div>
    </div>
  </div>
</div>

<div class="page-bottom"></div>

<!-- â•â•â•â•â•â•â•â•â•â• BOTTOM NAV â•â•â•â•â•â•â•â•â•â• -->
<div class="bottom-nav">
  <a href="home.html" class="nav-item">
    <i class="fas fa-home"></i><span>Home</span>
  </a>
  <a href="plans.html" class="nav-item">
    <i class="fas fa-chart-line"></i><span>Plans</span>
  </a>
  <a href="investments.html" class="nav-center" title="My Investments">
    <i class="fas fa-wallet"></i>
  </a>
  <a href="referrals.html" class="nav-item">
    <i class="fas fa-users"></i><span>Referrals</span>
  </a>
  <a href="dashboard.html" class="nav-item">
    <i class="fas fa-user-circle"></i><span>Profile</span>
  </a>
</div>

<!-- â•â•â•â•â•â•â•â•â•â• SCRIPT â•â•â•â•â•â•â•â•â•â• -->
<script>

/* â”€â”€ Firebase â”€â”€ */
const firebaseConfig = {
  apiKey:            "AIzaSyCFwefJ8rxZUDLbDsRHnHdA-28zPs49rlo",
  authDomain:        "cashpoint-ac4f4.firebaseapp.com",
  projectId:         "cashpoint-ac4f4",
  storageBucket:     "cashpoint-ac4f4.firebasestorage.app",
  messagingSenderId: "16133206416",
  appId:             "1:16133206416:web:a093f4e153ad2c9bcc8315"
};
if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db   = firebase.firestore();

/* â”€â”€ State â”€â”€ */
let currentUser    = null;
let selectedAmount = 0;

/* â”€â”€ Preset amounts â€” matched to plan prices â”€â”€ */
const PRESETS = [
  { amount: 3000,   label: 'â‚¦3,000',   plan: 'Basic Plan' },
  { amount: 6000,   label: 'â‚¦6,000',   plan: 'Starter Plan' },
  { amount: 12000,  label: 'â‚¦12,000',  plan: 'Silver Plan' },
  { amount: 24000,  label: 'â‚¦24,000',  plan: 'Gold Plan' },
  { amount: 48000,  label: 'â‚¦48,000',  plan: 'Platinum Plan' },
  { amount: 96000,  label: 'â‚¦96,000',  plan: 'Diamond Plan' },
  { amount: 192000, label: 'â‚¦192K',    plan: 'Elite Plan' },
  { amount: 384000, label: 'â‚¦384K',    plan: 'VIP Plan' },
  { amount: 768000, label: 'â‚¦768K',    plan: 'Ultimate Plan' }
];

/* â”€â”€ Clock â”€â”€ */
function tickClock() {
  document.getElementById('topClock').textContent =
    new Date().toLocaleTimeString([], { hour:'2-digit', minute:'2-digit' });
}
tickClock();
setInterval(tickClock, 1000);

/* â”€â”€ Formatters â”€â”€ */
function fmtFull(n) {
  return Number(n||0).toLocaleString('en-NG', { minimumFractionDigits:2, maximumFractionDigits:2 });
}
function fmtN(n) {
  return Number(n||0).toLocaleString('en-NG');
}

/* â”€â”€ Render preset amount buttons â”€â”€ */
function renderPresets() {
  const grid = document.getElementById('amountsGrid');
  grid.innerHTML = '';
  PRESETS.forEach(p => {
    const btn = document.createElement('button');
    btn.className = 'amt-btn';
    btn.dataset.amount = p.amount;
    btn.innerHTML = `
      <div class="amt-label">${p.label}</div>
      <div class="amt-earn">${p.plan}</div>
    `;
    btn.addEventListener('click', () => {
      document.querySelectorAll('.amt-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      selectedAmount = p.amount;
      document.getElementById('customAmtInput').value = '';
      updatePreview(p.amount, p.plan);
    });
    grid.appendChild(btn);
  });
}
renderPresets();

/* â”€â”€ Custom amount input â”€â”€ */
function onCustomInput(val) {
  document.querySelectorAll('.amt-btn').forEach(b => b.classList.remove('active'));
  const n = parseInt(val) || 0;
  selectedAmount = n;
  if (n >= 3000) {
    /* Find matching plan or closest */
    const match = PRESETS.slice().reverse().find(p => n >= p.amount);
    updatePreview(n, match ? match.plan : 'â€”');
  } else {
    hidePreview();
  }
}

function updatePreview(amount, planLabel) {
  const preview = document.getElementById('amountPreview');
  preview.classList.add('visible');
  document.getElementById('previewAmt').textContent = 'â‚¦' + fmtN(amount);
  document.getElementById('previewPlan').textContent = planLabel;
}
function hidePreview() {
  document.getElementById('amountPreview').classList.remove('visible');
}

/* â”€â”€ Auth â”€â”€ */
auth.onAuthStateChanged(async (user) => {
  if (!user) { window.location.href = 'login.html'; return; }
  currentUser = user;

  try {
    const snap = await db.collection('users').doc(user.uid).get();
    if (snap.exists) {
      const d = snap.data();
      document.getElementById('balanceDisplay').textContent = fmtFull(d.balance || 0);
      const fn = (d.fullName || d.username || 'U').split(' ')[0];
      document.getElementById('avatarBox').textContent = fn.charAt(0).toUpperCase();
    }
  } catch(e) { console.error('Balance error:', e); }

  await loadDepositHistory();
});

/* â”€â”€ Copy field â”€â”€ */
function copyField(text, btn) {
  const original = btn.innerHTML;
  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(text).then(() => {
      btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
      setTimeout(() => { btn.innerHTML = original; }, 2000);
    }).catch(() => fallbackCopy(text, btn, original));
  } else {
    fallbackCopy(text, btn, original);
  }
}
function fallbackCopy(text, btn, original) {
  const el = document.createElement('textarea');
  el.value = text;
  el.style.cssText = 'position:fixed;opacity:0;';
  document.body.appendChild(el);
  el.select();
  try {
    document.execCommand('copy');
    btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
    setTimeout(() => { btn.innerHTML = original; }, 2000);
  } catch(e) {}
  document.body.removeChild(el);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SUBMIT DEPOSIT
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   NO WhatsApp. Pure Firestore request.
   Admin panel reads 'deposits' collection
   and approves/rejects manually.
   User provides their transfer reference
   so admin can verify the bank transfer.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function submitDeposit() {
  if (!selectedAmount || selectedAmount < 3000) {
    Swal.fire({
      icon: 'warning',
      title: 'Select an Amount',
      text: 'Please choose or enter a deposit amount of at least â‚¦3,000.',
      confirmButtonColor: '#0052FF'
    });
    return;
  }

  /* â”€â”€ Ask user for their bank transfer reference/narration â”€â”€ */
  const { value: transferRef, isConfirmed } = await Swal.fire({
    title: 'Confirm Your Transfer',
    html: `
      <div style="font-family:'Plus Jakarta Sans',sans-serif;text-align:left;">
        <div style="background:#F0F4FF;border-radius:12px;padding:14px;margin-bottom:14px;">
          <div style="font-size:11px;color:#6B7A99;font-weight:700;text-transform:uppercase;margin-bottom:3px;">Amount to Transfer</div>
          <div style="font-size:28px;font-weight:700;color:#0D1B3E;font-family:'Sora',sans-serif;">â‚¦${fmtN(selectedAmount)}</div>
          <div style="font-size:12px;color:#6B7A99;margin-top:3px;">To: PalmPay Â· 9167378733 Â· TAUFEEK MUFTAU</div>
        </div>
        <div style="font-size:12.5px;color:#6B7A99;margin-bottom:10px;font-weight:600;">
          After transferring, enter your bank transfer reference or narration below so admin can verify your payment:
        </div>
        <input id="swalTransferRef" placeholder="e.g. TRF/2024/ABC123 or your name" 
          style="width:100%;padding:11px 14px;font-size:14px;border:2px solid #D8E0F0;border-radius:10px;outline:none;font-family:inherit;" />
        <div style="font-size:11px;color:#6B7A99;margin-top:6px;">This helps admin match your payment quickly.</div>
      </div>
    `,
    showCancelButton: true,
    confirmButtonText: 'âœ… Submit Deposit Request',
    cancelButtonText: 'Cancel',
    confirmButtonColor: '#0052FF',
    cancelButtonColor: '#6B7A99',
    preConfirm: () => {
      const val = document.getElementById('swalTransferRef').value.trim();
      if (!val) {
        Swal.showValidationMessage('Please enter your transfer reference or narration');
        return false;
      }
      return val;
    }
  });

  if (!isConfirmed) return;

  Swal.fire({
    title: 'Submitting Request...',
    allowOutsideClick: false,
    didOpen: () => Swal.showLoading()
  });

  try {
    const uSnap = await db.collection('users').doc(currentUser.uid).get();
    const uData = uSnap.exists ? uSnap.data() : {};
    const refCode = 'DEP-' + Date.now().toString(36).toUpperCase().slice(-6);

    /* â”€â”€ Save full deposit record to Firestore â”€â”€ */
    await db.collection('deposits').add({
      userId:         currentUser.uid,
      userEmail:      currentUser.email || uData.email || '',
      userName:       uData.fullName || uData.username || currentUser.email || 'Unknown',
      userPhone:      uData.phone || '',
      amount:         selectedAmount,
      refCode,
      transferRef:    transferRef,   /* user's bank transfer reference */
      status:         'pending',     /* admin changes to approved / rejected */
      paymentMethod:  'bank_transfer',
      bankName:       'PalmPay',
      accountName:    'TAUFEEK MUFTAU',
      accountNumber:  '9167378733',
      createdAt:      firebase.firestore.FieldValue.serverTimestamp(),
      updatedAt:      firebase.firestore.FieldValue.serverTimestamp(),
      adminNote:      '',
      approvedAt:     null
    });

    Swal.close();

    await Swal.fire({
      icon: 'success',
      title: 'âœ… Deposit Request Submitted!',
      html: `
        <div style="font-family:'Plus Jakarta Sans',sans-serif;text-align:center;">
          <div style="font-size:22px;font-weight:800;color:#0D1B3E;margin-bottom:4px;">â‚¦${fmtN(selectedAmount)}</div>
          <div style="font-size:13px;color:#6B7A99;margin-bottom:14px;">Pending admin approval</div>
          <div style="background:#F0F4FF;border-radius:10px;padding:10px 14px;display:inline-block;margin-bottom:10px;">
            <div style="font-size:11px;color:#6B7A99;font-weight:700;">Your Reference Code</div>
            <div style="font-size:17px;font-weight:800;color:#0052FF;letter-spacing:1px;">${refCode}</div>
          </div>
          <div style="font-size:12px;color:#6B7A99;line-height:1.6;">
            Admin will verify your transfer and credit your balance<br>within <b>5â€“30 minutes</b>. No action needed from you.
          </div>
        </div>
      `,
      confirmButtonText: 'OK',
      confirmButtonColor: '#0052FF'
    });

    selectedAmount = 0;
    document.getElementById('customAmtInput').value = '';
    document.querySelectorAll('.amt-btn').forEach(b => b.classList.remove('active'));
    hidePreview();
    await loadDepositHistory();

  } catch(err) {
    console.error('Deposit submit error:', err);
    Swal.fire({
      icon: 'error',
      title: 'Submission Failed',
      text: 'Could not save your deposit request. Check your connection and try again.',
      confirmButtonColor: '#0052FF'
    });
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOAD DEPOSIT HISTORY
   Shows the user their own past deposits
   with status: pending / approved / rejected
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function loadDepositHistory() {
  try {
    const rawSnap = await db.collection('deposits')
      .where('userId', '==', currentUser.uid)
      .get();

    /* Sort newest first client-side â€” no Firestore composite index needed */
    const snap = { docs: rawSnap.docs.sort((a, b) => {
      const at = a.data().createdAt ? a.data().createdAt.toMillis() : 0;
      const bt = b.data().createdAt ? b.data().createdAt.toMillis() : 0;
      return bt - at;
    }).slice(0, 20), empty: rawSnap.empty };

    const hist = document.getElementById('depositHistory');
    hist.innerHTML = '';

    /* Update pending count badge */
    const pendingCount = rawSnap.docs.filter(d => d.data().status === 'pending').length;
    if (pendingCount > 0) {
      document.getElementById('pendingWrap').style.display = 'block';
      document.getElementById('pendingCount').textContent = pendingCount;
    } else {
      document.getElementById('pendingWrap').style.display = 'none';
    }

    if (snap.empty) {
      hist.innerHTML = `
        <div class="empty-history">
          <div class="empty-history-emoji">ğŸ“­</div>
          <div class="empty-history-title">No Deposits Yet</div>
          <div class="empty-history-sub">Your deposit history will appear here after your first deposit.</div>
        </div>`;
      return;
    }

    const iconMap   = { pending:'â³', approved:'âœ…', rejected:'âŒ' };
    const labelMap  = { pending:'Pending', approved:'Approved', rejected:'Rejected' };

    snap.docs.forEach((doc, i) => {
      const d = doc.data();
      const status  = d.status || 'pending';
      const dateStr = d.createdAt
        ? d.createdAt.toDate().toLocaleDateString('en-NG', {
            day:'2-digit', month:'short', year:'numeric',
            hour:'2-digit', minute:'2-digit'
          })
        : 'Just now';

      const item = document.createElement('div');
      item.className = 'dep-item';
      item.style.animationDelay = (i * 0.05) + 's';
      item.innerHTML = `
        <div class="dep-icon ${status}">${iconMap[status] || 'ğŸ’°'}</div>
        <div class="dep-info">
          <div class="dep-amount">â‚¦${fmtN(d.amount)}</div>
          <div class="dep-date">${dateStr}</div>
        </div>
        <div class="dep-right">
          <div class="dep-badge ${status}">${labelMap[status] || status}</div>
          <div class="dep-ref">${d.refCode || ''}</div>
        </div>
      `;
      hist.appendChild(item);
    });

  } catch(err) {
    console.error('History load error:', err);
    /* If index not ready yet, show basic empty state */
    document.getElementById('depositHistory').innerHTML = `
      <div class="empty-history">
        <div class="empty-history-emoji">ğŸ“­</div>
        <div class="empty-history-title">No Deposits Yet</div>
        <div class="empty-history-sub">Your deposit history will appear here.</div>
      </div>`;
  }
}

</script>
</body>
</html>
